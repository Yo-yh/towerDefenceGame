{"version":3,"sources":["file:///D:/Gameproject/NewProject-001/assets/script/pao.ts"],"names":["_decorator","Component","Node","Sprite","SpriteFrame","resources","Layers","Vec2","ccclass","property","pao","start","node","on","EventType","MOUSE_UP","event","parent","getChildByName","console","log","destroy","addComponent","setPosition","load","_err","spriteFrame","getComponent","layer","Enum","UI_2D","TOUCH_MOVE","touch","_point","x","pos","getLocationX","getLocationY","convertToNodeSpaceAR","y","onload","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Sprite, SpriteFrame, resources, director, Layers, Scene, UITransform, Vec2} from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('pao')\r\nexport class pao extends Component {\r\n    start() {\r\n        //TODO：需要将该点击监听独立为一个函数，被多个道具节点所调用。\r\n        this.node.on(Node.EventType.MOUSE_UP, (event) => {\r\n            //判断是否已经存在文字框，避免重复创建文字框组件;\r\n            if (this.node.parent.parent.getChildByName('infoBox')){\r\n                //TODO：当当前显示的内容为其他道具时，需要动态渲染文字框内的内容。\r\n                //TODO: 当前显示的内容为本道具时，销毁文字框。\r\n                console.log('文字框节点已存在，正在销毁')\r\n                this.node.parent.parent.getChildByName('infoBox').destroy();\r\n            }else{\r\n                console.log('Mouse down');\r\n                let node = new Node('infoBox');\r\n                node.addComponent(Sprite);\r\n                // node.getComponent(Sprite).spriteFrame = new SpriteFrame(url.raw(\"resources/game/wenzikuang\"))\r\n                node.setPosition(-500,10,0);\r\n                resources.load('wenzikuang/spriteFrame',SpriteFrame,(_err,spriteFrame)=>{\r\n                    node.getComponent(Sprite).spriteFrame = spriteFrame;\r\n                    //在cocos3x版本中，layer默认为default，node.layer = Layers.Enum.UI_2D；\r\n                    //2d摄像头可见的是UI_2D和UI_3D\r\n                    node.layer = Layers.Enum.UI_2D;\r\n                    console.log(node);\r\n                    console.log('文字框创建成功');\r\n                })\r\n                // director.getScene().addChild(node);\r\n                \r\n                // this.node.addChild(node);\r\n            }\r\n          }, this);\r\n\r\n          this.node.on(Node.EventType.TOUCH_MOVE,(event)=>{\r\n            console.log('正在拖动')\r\n            if (this.node.parent.parent.parent.getChildByName('pao1')){\r\n                // console.log('炮节点已存在，正在移动')\r\n                //event.touch._point获得的鼠标位置是相对画布左下角的，而当前的锚点是在正中心\r\n                //TODO：增加防抖操作\r\n                console.log(event.touch._point.x);\r\n                //触摸点的世界坐标\r\n                let pos = new Vec2(event.getLocationX(),event.getLocationY());\r\n                //转换为UI作表\r\n                pos=this.node.convertToNodeSpaceAR(pos)\r\n                let x = event.touch._point['x']-450;\r\n                let y = event.touch._point['y']-800;\r\n                this.node.parent.parent.parent.getChildByName('pao1').setPosition(x,y,0)\r\n                // this.node.parent.parent.getChildByName('pao1').destroy();\r\n            }else{\r\n            //TODO:同时使用多个炮的时候可能会造成冲突\r\n                let node = new Node('pao1');\r\n                node.addComponent(Sprite);\r\n                resources.load('pao/spriteFrame',SpriteFrame,(_err,spriteFrame)=>{\r\n                    node.getComponent(Sprite).spriteFrame = spriteFrame;\r\n                    //在cocos3x版本中，layer默认为default，node.layer = Layers.Enum.UI_2D；\r\n                    //2d摄像头可见的是UI_2D和UI_3D\r\n                    node.layer = Layers.Enum.UI_2D;\r\n                    // node.setPosition(event.touch.point.x)\r\n                    // console.log(node);\r\n                    // console.log(event.touch._point.x);\r\n                    console.log('炮创建成功');\r\n                })\r\n                //放在战斗组，目前还没定义战斗组，所有放在顶层；\r\n                node.parent = this.node.parent.parent.parent;\r\n                let x = event.touch._point['x'];\r\n                let y = event.touch._point['y'];\r\n                node.setPosition(x,y,0);\r\n            }\r\n          },this)\r\n          \r\n    }\r\n    onload(){\r\n        \r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        \r\n    }\r\n}\r\n\r\n\r\n"]}